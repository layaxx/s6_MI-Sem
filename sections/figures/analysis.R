library(pacman)
p_load(ggplot2)

data <- data.frame(
  number_entries = c(1020, 1022, 8158),
  avg_documents = c(76.18333333333334, 76.0440313111546, 60.5725668055896),
  abstractness = c(0.690695595612553, 0.682458735821815, 0.671530640779557),
  compression = c(1214.22189329372, 1150.50993540137, 1073.2936988159),
  redundancy = c(-0.341208296351387, -0.34589620810695, -0.344682693268784),
  relevance = c(-38.3230837187221, -42.6577370328381, -31.4050728009646),
  dataset = c("VAL", "TEST", "TRAIN")
)

# melt the data frame for plotting
data.m <- melt(data)


data.m
# plot everything
ggplot(data.m, aes(dataset, value)) +
  geom_bar(fill = "#6e9fea", position = "stack", stat = "identity") +
  geom_text(aes(label = round(value, digits = 2)),
    color = "white", angle = 0,
    position = position_stack(vjust = 0.5)
  ) +
  facet_wrap(~variable, scales = "free") +
  theme(axis.title = element_blank())




red_val <- c(-0.23278095351629088, -0.24722003556009395, -0.32075504438410835, -0.16950412409412635, -0.5353338375566331, -0.3028489298575035, -0.6140333438649563, -0.48359462059528435, -0.6138412399985858, -0.16734719949877355, -0.18189350758774822, -0.3934270129308767, -0.20061389169329266, -0.42312433974076263, -0.19966845540891648, -0.33510069357983163, -0.32793126736320644, -0.2854073187058625, -0.43636056168684134, -0.28859026460117726, -0.6370086955943638, -0.30500827712154993, -0.2879628236501763, -0.1249889905648931, -0.5827499577288254, -0.41240266060739655, -0.18270933792685984, -0.24475821585808943, -0.07791944270343451, -0.5200793493686959, -0.2456119177835155, -0.10995171602376674, -0.1288486520704125, -0.3308189774258863, -0.7056944092188421, -0.34021697307186544, -0.15306263474059895, -0.22064941116154654, -0.2664235474622544, -0.18159893224744098, -0.30329941001699245, -0.5712020555704062, -0.20648015923574373, -0.19154608813289217, -0.5559023081162543, -0.2116449758641103, -0.5545777880217617, -0.5040227653708603, -0.06363757014223671, -0.1308628816986187, -0.23860377712632214, -0.2493392985661562, -0.16972296089072514, -0.3596083608993155, -0.5583617994292983, -0.14306145184583938, -0.6700862585962764, -0.2382643003487123, -0.4845255329220664, -0.30565745188873666, -0.47659276004696655, -0.2169663151284917, -0.3135888529009934, -0.3476035589974272, -0.4512394891846965, -0.46480245413104465, -0.6511953920094085, -0.12841104654395205, -0.5037019816723275, -0.42131408204906584, -0.5524231582377139, -0.5344094094980153, -0.28240403726534463, -0.18808623565429433, -0.650862546368405, -0.11797722333178878, -0.42579232751705226, -0.46131761757832357, -0.25186615292928494, -0.6574927072767107, -0.19507271278765087, -0.5485830882259697, -0.19067610178177188, -0.15347410365120256, -0.3742478367294529, -0.3821516411774036, -0.13747455881205492, -0.4580325481158058, -0.39885000606934506, -0.2070290712816903, -0.19358452503565712, -0.2673619105095539, -0.13508632124310144, -0.41302229410253943, -0.45277926487412934, -0.38258277640227784, -0.48189623369104717, -0.4696553077024086, -0.383286680120703, -0.26968654526497265)
rel_val <- c(-33.02257477943857, -63.94593192031566, -16.629496027030907, -19.323746829813338, -26.63546437719905, -46.001963437584415, -29.367166530545145, -65.63950457005919, -46.731642597115, -18.947822254237828, -12.729544854076229, -24.929709723216643, -47.56136576043517, -18.79359796148666, -62.16924281517619, -54.45909806270425, -59.79378669795698, -17.66632701613646, -62.50870237178845, -46.001323293603534, -50.84326337201809, -41.75462215960145, -58.077218497652254, -6.51784083229135, -50.7660764338384, -66.87850884801459, -62.381620967586784, -14.301873872576138, -17.84708427092391, -53.81258870476139, -16.284751572758058, -14.759561564806983, -8.603933898823493, -20.235498553997576, -49.18530999103635, -51.80167378215939, -2.209973252334993, -7.829398286962621, -66.10639176644855, -22.06086140279467, -69.47345416554866, -6.615341112641194, -50.717127221580576, -5.737098393789158, -4.66078010222815, -33.37761131348265, -53.726244531110076, -55.47932135325932, -13.34685656529216, -38.10567242554929, -49.27198793712366, -44.400232521396205, -23.851308681382868, -52.90661138361635, -52.35790033019351, -7.743701827690913, -46.08697429461495, -54.386676267835846, -19.99669074593032, -65.21735699469777, -60.78069902995554, -48.20043372794156, -23.85754043556702, -60.5439286596222, -61.33649729602842, -33.610786038412506, -32.187157310087926, -8.677735307303859, -38.72788704609585, -8.402536820373676, -41.17955567766076, -43.268649304878295, -66.31008957657542, -30.990708177230527, -47.06448208198811, -61.56368877510114, -48.30340833140353, -55.58852869830826, -3.053611156728488, -49.11140878400083, -27.324469578203914, -43.59935479384138, -34.10831066251476, -8.124219682583949, -34.692554421437, -44.2227858313231, -32.68391798860231, -68.686813262977, -59.87653702875173, -28.269043191273905, -67.82027189142065, -11.913438952315893, -40.190731081930124, -51.27119481218802, -60.806725916540536, -74.20674449508326, -28.059282676977695, -24.547783067594068, -58.88980971268651, -7.680038508427756)

red_test <- c(-0.5506916751552086, -0.3526881752148425, -0.43520996464383555, -0.0682576576814535, -0.3827498338981592, -0.38257599062720693, -0.21690140659223806, -0.4720214956279649, -0.3853117443759349, -0.2231711390514159, -0.460481681632551, -0.27830429733321105, -0.34100318097545884, -0.13462181891177738, -0.4144594559672469, -0.06556850149544796, -0.15888835130014434, -0.3811615511584468, -0.3351414408672715, -0.692339003474938, -0.38828992060982426, -0.203186935956644, -0.2777678311450298, -0.3485932190051314, -0.5753432754036817, -0.291531495608067, -0.5442556055409197, -0.4246608149868634, -0.5766398526673421, -0.2614566938050479, -0.14357582801862712, -0.18310858586369433, -0.15034523776672318, -0.4584388274261581, -0.28136639056865714, -0.5525267057342329, -0.4371727515414178, -0.15444718846741462, -0.5264008900959314, -0.22691267428506395, -0.2718860806865597, -0.2697900030084784, -0.34559980378846106, -0.6361754429433791, -0.2234338280924827, -0.36668787280353593, -0.28827886115951845, -0.514308386884254, -1.2529507114649798, -0.3887303980960059, -0.5236210132977875, -0.49795836720028147, -0.6194521246301565, -0.5279818655844554, -0.3508358942718695, -0.5934072369368671, -0.07209533656945624, -0.25379351170667513, -0.07294646926860396, -0.39697558381923914, -0.3990766627092863, -0.08799892187549338, -0.6365402081829596, -0.41431718589538474, -0.3776454909197469, -0.17598648825269145, -0.20328070604157425, -0.3830598889009896, -0.2539836461455315, -0.6857144210297862, -0.09294148710389305, -0.22645682064895742, -0.49894349378332414, -0.08463980128282758, -0.3374764696536131, -0.2807999029478622, -0.15702719004271712, -0.5713104051109429, -0.37014677518365974, -0.05884101421936329, -0.24525415733008304, -0.25086446802288037, -0.3455753804949518, -0.2688842409559772, -0.5987412024533357, -0.19393542272370112, -0.14607362370111474, -0.32352916373352414, -0.3337353462710784, -0.21519756284480493, -0.4384587176274947, -0.2617715602089426, -0.4591347897015514, -0.20903676549488448, -0.4135203405728703, -0.16955295268510595, -0.15518870670217516, -0.0523745291354176, -0.3893881576139583, -0.6187388597962038)
rel_test <- c(-31.152233915963734, -54.623248508277484, -10.539750845251376, -56.295296189479714, -56.75355738802343, -57.33338084932504, -40.40693929705246, -30.374842283935354, -63.83186337368804, -54.949899477619205, -34.66852346580105, -67.27628154456734, -34.019917385908755, -50.577015274584454, -42.21385649972536, -7.2448285924489495, -2.258008313152942, -49.681481353897354, -56.91287603918968, -12.675576858848178, -65.1190426753693, -28.636285735205533, -63.52063804208861, -80.28055877008194, -33.776947058991176, -61.952769926880926, -35.563597667430635, -66.00513065108318, -33.3393390797426, -68.76099019451527, -29.182038021962445, -56.299545312261024, -1.797772100057347, -22.894297731619975, -50.450902424061475, -44.517259742641166, -49.772144868014124, -62.017839771691, -44.01661120760488, -39.394079720474224, -69.16923516033485, -68.1982760591796, -26.46356206532776, -50.11556475217022, -14.816132509560687, -50.858405120530335, -51.33139648091793, -41.314370333498644, -29.4385731652783, -50.56630638833134, -31.842592212820932, -6.719857461326223, -40.78667833714723, -63.18284268390975, -61.35023742236043, -43.16258181076476, -22.753285151010367, -61.11324167001053, -0.5, -62.971971182989165, -4.465029445770698, -2.3844819633829433, -51.79843936933243, -56.337393208736046, -60.79910405919521, -55.69549131177313, -66.39440596549952, -17.209156962529782, -60.168371813838235, -29.31934668565358, -44.21767209275984, -36.32391409743877, -45.46167750620541, -44.450142914229446, -39.366611291147045, -15.618399468642462, -15.831727603865453, -54.61568936073001, -51.477794819563165, 0.0, -35.43624171699887, -59.18964620942433, -34.418481326906054, -62.6876301280733, -46.43579151572595, -61.21529709772266, -3.1954538096849667, -33.58434775940498, -16.12714439386422, -58.51988869594706, -64.42341414915306, -44.63935386314768, -30.7847404295914, -53.337939328651046, -68.16813372032696, -69.70469879387805, -69.3273847952352, -11.099004162747923, -38.95086451675253, -54.85111880429583)

red_train <- c(-0.37825818557036883, -0.31842076885881915, -0.27570631345171237, -0.2630761290855616, -0.1445112641037049, -0.29652606620726873, -0.19397157882048968, -0.3031182709457237, -1.079708117639618, -0.42984928109586756, -0.46267792026157906, -0.5209103765637626, -0.2783429541335041, -0.4160156776997352, -0.3314773839774295, -0.10207681912715605, -0.4837904453009753, -0.28574272551529883, -0.3036765651744944, -0.6545593337706338, -0.46075626907628103, -0.19615779136480768, -0.2626411538268495, -0.5749834619026779, -0.18048576183509576, -0.16113330735782294, -0.22980520590504336, -0.10361835881396231, -0.48476271285563427, -0.13645469776530675, -0.2810839224487323, -0.33232984760281975, -0.05014087798806157, -0.6559821980695704, -0.3296178493863831, -0.2335405358767738, -0.27284585306739123, -0.6705963636293353, -0.3055723705078677, -0.04357911342349892, -0.635858699499313, -0.34016864184407003, -0.5225711848832796, -0.2347046406858482, -0.5847500486689853, -0.1944675215404448, -0.3672617863533344, -0.20513038924815677, -0.19728063473324342, -0.29319755861164265, -0.25051715969915156, -0.0668116660677515, -0.41877207604247346, -0.6025678313429021, -0.22886324623071824, -0.13326920934728723, -0.16382815460821254, -0.3643017200860461, -0.3630052230660463, -0.1815131757433828, -0.640273383301805, -0.2530525438467918, -0.24130764116162542, -0.27002312227177866, -0.6403532844295969, -0.2991683080850732, -0.17965009224127412, -0.43119556149482074, -0.12642387282391268, -0.13060590120259982, -0.648918350419478, -0.25943593949754934, -0.32272046998258375, -0.9426632305744537, -0.24360272913791237, -0.4826388350358378, -0.35955509290513493, -0.3551194632354214, -0.1721285706580363, -0.3203350323187358, -0.10017952533296366, -0.26764540177427437, -0.9202434834668054, -0.0807383167820068, -0.5774128252171445, -0.6793322914696123, -0.1795703622233195, -0.13744522659328653, -0.3606643245066593, -0.3015995935689667, -0.2098370161431224, -0.21678545093270515, -0.379751582611216, -0.2773324026882235, -0.6065699163465731, -0.5554204588680818, -0.428133648083053, -0.24841556284335223, -0.5231318374381696, -0.2615442770545019)
rel_train <- c(-26.027180199208477, -40.24446971432327, -9.915221902114437, -7.043469487102728, -28.956848621129538, -58.793278214199745, -58.743657689041854, -35.072550726357356, -12.654926412031951, -55.6911326556324, -58.26813362545484, -68.1851950511249, -34.022911057820735, -8.965129366360667, -9.923319145445124, -13.316635362113027, -13.530000435561394, -32.61805777800561, -16.251434128951676, -34.123724168215894, -62.235665354025166, -16.992976387411694, -28.748596292739812, -53.23934278074026, -70.8729747756635, -11.080988940769004, -31.145248580651465, -2.558924185158126, -54.62380196465316, 0.0, -4.4534639917432495, -40.029241442514504, -6.427624554951192, -55.87343535645384, -34.59231565788237, -1.8372113432815247, -63.48695993695472, -5.405662146642311, -53.87501444562368, -8.105699604369871, -50.337468539454214, -25.08060390096866, -51.803603141287326, -14.549625925363598, -35.62229138484581, -3.219377220063738, -47.34358382369685, -40.175390717827845, -7.6416968513561665, -55.70972562902762, -62.23225259803518, -9.987277055111647, -63.13684726205588, -41.42843907474656, -69.42377216365082, -4.696495410662903, -27.96581245532276, -50.70232911511947, -15.202841015752725, -6.85165081481176, -41.06733815692734, -51.14016309887202, -12.3431663855705, -52.90173161774411, -63.07858991565505, -5.0314180840416896, -1.3333126794408001, -49.93682225929674, -8.111440409952323, -1.3328374591438477, -44.40713623264122, -72.74472614539266, -60.22995086120911, -1.7288053871476663, -65.01802594733259, -30.190409621037556, -5.205489358746343, -6.347580987172056, -4.234407944923098, -47.87372255781675, -2.4995685534899685, -31.764776025123087, -31.843459559062094, -6.283760557657095, -38.61037381127381, -33.74033492962226, -0.5, -10.309593803345688, -28.702635046080598, -23.6423763008049, -63.441455324888594, -12.129495371129037, -25.968677338034357, -11.983424589399538, -7.89257598594711, -53.84299227041981, -51.41015368644649, -73.27407696948025, -60.96656318021295, -36.400404102392784)

red_complete <- append(red_val, red_test)
red_complete <- append(red_complete, red_train)

rel_complete <- append(rel_val, rel_test)
rel_complete <- append(rel_complete, rel_train)



data <- data.frame(red_complete, rel_complete, set = rep(c("VAL", "TEST", "TRAIN"), each = 100))

dim(data)

ggplot(data) +
  geom_point(aes(x = red_complete, y = rel_complete, color = set), size = 2) +
  xlab("Redundancy") +
  ylab("Relevance")
